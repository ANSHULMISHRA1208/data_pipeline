[tox]
envlist = py26, py27, py33, style, docs
indexserver =
# BEFORE PROD - see https://trac.yelpcorp.com/wiki/InternalPyPI
# Switch to the production pypi server
#   default = https://pypi.yelpcorp.com/simple/
    default = https://pypi-dev.yelpcorp.com/simple/

[testenv]
deps = -rrequirements-dev.txt
commands =
    coverage run --rcfile tox.ini --source data_pipeline/,tests/ -m pytest --strict {posargs}
    coverage report --rcfile tox.ini -m

[testenv:style]
deps = {[testenv]deps}
commands =
    flake8 .

[testenv:docs]
deps =
    {[testenv]deps}
    sphinx
changedir = docs
commands = sphinx-build -b html -d build/doctrees ./ build/html

[testenv:devenv]
envdir = virtualenv_run
commands =

[flake8]
ignore =
exclude = .svn,CVS,.bzr,.hg,.git,__pycache__,.tox,docs,virtualenv_run

[pytest]
norecursedirs = .* _darcs CVS docs virtualenv_run

[report]
exclude_lines =
    pragma: no cover
    raise NotImplementedError
